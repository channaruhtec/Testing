<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track Order - Gem Cabinet</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'gem-dark': '#0f172a',
                        'gem-darker': '#020617',
                        'gem-gold': '#d4af37',
                        'gem-accent': '#1e293b',
                    },
                    fontFamily: {
                        serif: ['Playfair Display', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
</head>

<body class="bg-gem-darker text-gray-200 font-sans antialiased selection:bg-gem-gold selection:text-gem-darker">

    <!-- Navbar -->
    <nav class="fixed w-full z-50 top-0 left-0 bg-gem-dark/95 backdrop-blur-md border-b border-gem-accent transition-all duration-300"
        id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col items-center py-4 lg:flex-row lg:justify-between lg:h-24">
                <div class="flex items-center gap-4">
                    <!-- Mobile Cart Icon -->
                    <button onclick="window.location.href='inventory.html?openCart=true'"
                        class="relative p-2 text-gray-400 hover:text-gem-gold transition-colors focus:outline-none md:hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                        </svg>
                        <span
                            class="cart-count absolute -top-1 -right-1 bg-gem-gold text-gem-darker text-[10px] font-bold px-1.5 py-0.5 rounded-full hidden">0</span>
                    </button>

                    <div class="flex flex-col items-center lg:items-start">
                        <span
                            class="text-2xl lg:text-3xl font-serif font-bold tracking-[0.2em] text-white leading-tight">GEM
                            CABINET</span>
                        <span
                            class="text-[8px] lg:text-[10px] uppercase tracking-[0.4em] text-gem-gold font-medium mt-1">from
                            the mines of gemcity</span>
                    </div>
                </div>
                <div
                    class="flex items-center space-x-6 lg:space-x-10 text-[10px] lg:text-xs uppercase tracking-[0.2em] font-medium">
                    <a href="index.html" class="text-gray-400 hover:text-gem-gold transition-colors">Home</a>
                    <a href="inventory.html" class="text-gray-400 hover:text-gem-gold transition-colors">Inventory</a>
                    <a href="track.html" class="text-gem-gold">Track Order</a>
                    <a href="feedback.html" class="text-gray-400 hover:text-gem-gold transition-colors">Feedback</a>
                    <a href="about.html" class="text-gray-400 hover:text-gem-gold transition-colors">About</a>
                    <a href="contact.html" class="text-gray-400 hover:text-gem-gold transition-colors">Contact</a>

                    <!-- Auth Nav -->
                    <div class="auth-nav flex items-center border-l border-gray-800 pl-6 ml-4">
                        <a href="login.html" class="text-gray-400 hover:text-gem-gold transition-colors">Sign In</a>
                    </div>

                    <!-- Cart Icon -->
                    <button onclick="window.location.href='inventory.html?openCart=true'"
                        class="relative p-2 text-gray-400 hover:text-gem-gold transition-colors focus:outline-none group/cart">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                        </svg>
                        <span
                            class="cart-count absolute -top-1 -right-1 bg-gem-gold text-gem-darker text-[10px] font-bold px-1.5 py-0.5 rounded-full hidden">0</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="pt-40 pb-20 bg-gem-dark relative overflow-hidden">
        <div class="absolute inset-0 opacity-10">
            <div
                class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-gem-gold via-transparent to-transparent">
            </div>
        </div>
        <div class="relative max-w-7xl mx-auto px-4 text-center">
            <h1 class="text-5xl lg:text-6xl font-serif font-bold text-white mb-6">Track Your Order</h1>
            <div class="w-32 h-1 bg-gem-gold mx-auto mb-8"></div>
            <p class="text-gray-400 max-w-2xl mx-auto text-lg leading-relaxed font-light">
                Enter your Order ID below to view real-time updates on your gemstone's journey.
            </p>
        </div>
    </section>

    <!-- Track Content -->
    <section class="py-20 bg-gem-darker min-h-[60vh]">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-gem-dark p-8 rounded-sm border border-gem-accent">
                <form id="track-form" class="space-y-6">
                    <div>
                        <label class="block text-gray-400 text-xs uppercase tracking-widest mb-2 text-center">Enter
                            Order ID</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="order-id-input" placeholder="ORD-XXXXXX" required
                                class="flex-1 bg-gem-accent border border-gray-700 rounded-sm p-4 text-white focus:outline-none focus:border-gem-gold transition-colors text-center font-mono tracking-widest text-lg">
                            <button type="submit"
                                class="bg-gem-gold text-gem-darker font-bold px-8 py-4 rounded-sm hover:bg-yellow-500 transition-all duration-300 uppercase tracking-widest text-xs">
                                Track Now
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Status Screen -->
                <div id="status-container" class="hidden mt-12 space-y-12">
                    <div class="border-t border-gem-accent pt-8 flex flex-col items-center">
                        <div id="order-gems-list" class="space-y-2 mb-4 text-center">
                            <!-- Gem names list -->
                        </div>
                        <p id="order-date" class="text-gray-500 text-[10px] uppercase tracking-widest">Ordered on ...
                        </p>
                    </div>

                    <!-- Timeline -->
                    <div class="relative max-w-sm mx-auto">
                        <!-- Line -->
                        <div class="absolute left-[15px] top-0 bottom-0 w-[2px] bg-gray-800"></div>
                        <div id="timeline-progress"
                            class="absolute left-[15px] top-0 w-[2px] bg-gem-gold transition-all duration-1000"
                            style="height: 0%"></div>

                        <!-- Nodes -->
                        <div class="space-y-10 relative">
                            <div class="flex items-center gap-6 group" id="step-1">
                                <div
                                    class="w-8 h-8 rounded-full border-2 border-gray-800 bg-gem-dark flex items-center justify-center z-10 node-circle transition-all">
                                    <div class="w-2 h-2 rounded-full bg-transparent node-dot"></div>
                                </div>
                                <div>
                                    <h3 class="text-sm font-bold text-gray-400 uppercase tracking-widest node-text">
                                        Payment Received</h3>
                                    <p class="text-[10px] text-gray-600 uppercase tracking-widest mt-0.5">Order
                                        confirmed</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-6 group" id="step-2">
                                <div
                                    class="w-8 h-8 rounded-full border-2 border-gray-800 bg-gem-dark flex items-center justify-center z-10 node-circle transition-all">
                                    <div class="w-2 h-2 rounded-full bg-transparent node-dot"></div>
                                </div>
                                <div>
                                    <h3 class="text-sm font-bold text-gray-400 uppercase tracking-widest node-text">
                                        Getting Ready</h3>
                                    <p class="text-[10px] text-gray-600 uppercase tracking-widest mt-0.5">Gem processing
                                        & QC</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-6 group" id="step-3">
                                <div
                                    class="w-8 h-8 rounded-full border-2 border-gray-800 bg-gem-dark flex items-center justify-center z-10 node-circle transition-all">
                                    <div class="w-2 h-2 rounded-full bg-transparent node-dot"></div>
                                </div>
                                <div>
                                    <h3 class="text-sm font-bold text-gray-400 uppercase tracking-widest node-text">
                                        Dispatched to Mail</h3>
                                    <p class="text-[10px] text-gray-600 uppercase tracking-widest mt-0.5">With shipping
                                        carrier</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-6 group" id="step-4">
                                <div
                                    class="w-8 h-8 rounded-full border-2 border-gray-800 bg-gem-dark flex items-center justify-center z-10 node-circle transition-all">
                                    <div class="w-2 h-2 rounded-full bg-transparent node-dot"></div>
                                </div>
                                <div>
                                    <h3 class="text-sm font-bold text-gray-400 uppercase tracking-widest node-text">
                                        Delivered</h3>
                                    <p class="text-[10px] text-gray-600 uppercase tracking-widest mt-0.5">Arrived at
                                        destination</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Error Message -->
                <div id="error-message"
                    class="hidden mt-12 text-center p-4 bg-red-500/10 border border-red-500/30 rounded-sm">
                    <p class="text-red-400 text-sm">Order ID not found. Please check and try again.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black py-16 border-t border-gem-accent">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div
                class="flex flex-col md:flex-row justify-between items-center space-y-8 md:space-y-0 text-center md:text-left">
                <div>
                    <span class="text-xl font-serif font-bold text-white tracking-widest">GEM CABINET</span>
                    <p class="text-gray-600 text-xs mt-2 uppercase tracking-[0.2em] font-light">From the mines of
                        gemcity</p>
                </div>
                <div class="flex space-x-12 text-[10px] uppercase tracking-[0.3em] font-medium">
                    <a href="inventory.html"
                        class="text-gray-400 hover:text-gem-gold transition-colors underline decoration-gem-gold/20 underline-offset-8">Inventory</a>
                    <a href="feedback.html"
                        class="text-gray-400 hover:text-gem-gold transition-colors underline decoration-gem-gold/20 underline-offset-8">Feedback</a>
                </div>
                <div class="text-gray-600 text-[10px] uppercase tracking-widest leading-loose">
                    &copy; 2024 Gem Cabinet.<br>Sri Lanka.
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/orders.js"></script>
    <script>
        const form = document.getElementById('track-form');
        const container = document.getElementById('status-container');
        const error = document.getElementById('error-message');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const id = document.getElementById('order-id-input').value.trim().toUpperCase();

            // Combine global orders and local orders
            const localOrders = JSON.parse(localStorage.getItem('myOrders') || '[]');
            const allOrders = [...orders, ...localOrders];
            const matchingOrders = allOrders.filter(o => o.id === id);

            if (matchingOrders.length > 0) {
                showOrder(matchingOrders);
            } else {
                container.classList.add('hidden');
                error.classList.remove('hidden');
            }
        });

        function showOrder(matchingOrders) {
            const first = matchingOrders[0];
            error.classList.add('hidden');
            container.classList.remove('hidden');

            const list = document.getElementById('order-gems-list');
            list.innerHTML = '';
            matchingOrders.forEach(o => {
                const h2 = document.createElement('h2');
                h2.className = 'text-2xl font-serif text-gem-gold mb-1';
                h2.textContent = o.gemName;
                list.appendChild(h2);
            });

            document.getElementById('order-date').textContent = `Ordered on ${first.date}`;

            updateTimeline(first.status);
        }

        const statuses = ['Payment Received', 'Getting Ready', 'Dispatched to Mail', 'Delivered'];

        function updateTimeline(status) {
            const index = statuses.indexOf(status);
            const nodes = [1, 2, 3, 4];

            // Progress Line
            const progress = (index / (statuses.length - 1)) * 100;
            document.getElementById('timeline-progress').style.height = `${progress}%`;

            nodes.forEach((num, i) => {
                const node = document.getElementById(`step-${num}`);
                const circle = node.querySelector('.node-circle');
                const dot = node.querySelector('.node-dot');
                const text = node.querySelector('.node-text');

                if (i <= index) {
                    circle.classList.remove('border-gray-800');
                    circle.classList.add('border-gem-gold');
                    dot.classList.remove('bg-transparent');
                    dot.classList.add('bg-gem-gold');
                    text.classList.remove('text-gray-400');
                    text.classList.add('text-white');
                } else {
                    circle.classList.add('border-gray-800');
                    circle.classList.remove('border-gem-gold');
                    dot.classList.add('bg-transparent');
                    dot.classList.remove('bg-gem-gold');
                    text.classList.add('text-gray-400');
                    text.classList.remove('text-white');
                }
            });
        }
    </script>
    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/gems.js"></script>
    <script src="js/orders.js"></script>
    <script src="js/cart.js"></script>
</body>

</html>